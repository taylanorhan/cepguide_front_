{"ast":null,"code":"import React,{useContext,useEffect}from\"react\";import{Link,useNavigate}from\"react-router-dom\";import axios from\"axios\";import{GlobalContext}from\"../../context/GlobalState\";import\"./Cart.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Cart(){const{cart,user,setCart,clearCart}=useContext(GlobalContext);const navigate=useNavigate();useEffect(()=>{const fetchCart=async()=>{try{if(user&&user._id){// Check if user and user._id are defined\nconsole.log('Fetching cart for user:',user._id);const response=await axios.get('http://localhost:3000/cart',{params:{userId:user._id}});console.log('Cart response:',response.data);setCart(response.data);}else{console.log('User is not defined or user._id is missing');}}catch(error){console.error('Error fetching cart:',error);}};fetchCart();},[user,setCart]);const handleCheckout=async()=>{console.log('handleCheckout called');console.log('User:',user);console.log('Cart:',cart);try{if(user&&cart.length){console.log('User ID:',user.user._id);console.log('Cart Items:',cart);const response=await axios.post('http://localhost:3000/orders',{userId:user.user._id,items:cart});if(response.status===201){console.log('Order Successful:',response.data);// clearCart();\nnavigate('/checkout');}else{console.error('Order failed:',response.statusText);}}else{console.log('User or cart is not defined');}}catch(error){if(error.response){console.error('Order Error:',error.response.data);}else if(error.request){console.error('Order Error: No response from server',error.request);}else{console.error('Order Error:',error.message);}}};return/*#__PURE__*/_jsxs(\"div\",{className:\"cart-container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"Cart\"}),!cart.length?/*#__PURE__*/_jsx(\"p\",{children:\"No Excursions Added! Please add something to your cart.\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"cart-list\",children:cart.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item\",children:[/*#__PURE__*/_jsx(Link,{to:\"/item/\".concat(item.id),children:/*#__PURE__*/_jsx(\"img\",{src:item.image,alt:item.name,className:\"cart-image\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"item-details\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"item-name-price\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"item-name\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"item-price\",children:[\"\\u20BA\",item.price.toFixed(2)]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Adults: \",item.adults]}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Children: \",item.children]})]})})]},index))}),/*#__PURE__*/_jsx(\"button\",{className:\"item-btn\",onClick:handleCheckout,children:\"Next\"}),/*#__PURE__*/_jsx(Link,{to:\"/excursions\",children:/*#__PURE__*/_jsx(\"button\",{className:\"item-btn back-btn\",children:\"Back to Excursions\"})}),/*#__PURE__*/_jsx(\"button\",{style:{backgroundColor:\"red\"},className:\"item-btn\",onClick:()=>clearCart(),children:\"Clear\"})]})]});}export default Cart;","map":{"version":3,"names":["React","useContext","useEffect","Link","useNavigate","axios","GlobalContext","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Cart","cart","user","setCart","clearCart","navigate","fetchCart","_id","console","log","response","get","params","userId","data","error","handleCheckout","length","post","items","status","statusText","request","message","className","children","map","item","index","to","concat","id","src","image","alt","name","price","toFixed","adults","onClick","style","backgroundColor"],"sources":["/Users/orhan/Desktop/CepGuide/src/components/cart/Cart.js"],"sourcesContent":["import React, { useContext, useEffect } from \"react\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport { GlobalContext } from \"../../context/GlobalState\";\nimport \"./Cart.css\";\n\nfunction Cart() {\n  const { cart, user, setCart, clearCart } = useContext(GlobalContext);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchCart = async () => {\n      try {\n        if (user && user._id) { // Check if user and user._id are defined\n          console.log('Fetching cart for user:', user._id);\n          const response = await axios.get('http://localhost:3000/cart', {\n            params: { userId: user._id }\n          });\n          console.log('Cart response:', response.data);\n          setCart(response.data);\n        } else {\n          console.log('User is not defined or user._id is missing');\n        }\n      } catch (error) {\n        console.error('Error fetching cart:', error);\n      }\n    };\n\n    fetchCart();\n  }, [user, setCart]);\n\n  const handleCheckout = async () => {\n    console.log('handleCheckout called');\n    console.log('User:', user); \n    console.log('Cart:', cart); \n     \n    try {\n      if (user && cart.length) {\n        console.log('User ID:', user.user._id);\n        console.log('Cart Items:', cart);\n\n        const response = await axios.post('http://localhost:3000/orders', {\n          userId: user.user._id, \n          items: cart\n        });\n\n        if (response.status === 201) {\n          console.log('Order Successful:', response.data);\n          // clearCart();\n          navigate('/checkout');\n        } else {\n          console.error('Order failed:', response.statusText);\n        }\n      } else {\n        console.log('User or cart is not defined');\n      }\n    } catch (error) {\n      if (error.response) {\n        console.error('Order Error:', error.response.data);\n      } else if (error.request) {\n        console.error('Order Error: No response from server', error.request);\n      } else {\n        console.error('Order Error:', error.message);\n      }\n    }\n  };\n\n  return (\n    <div className=\"cart-container\">\n      <h1>Cart</h1>\n      {!cart.length ? (\n        <p>No Excursions Added! Please add something to your cart.</p>\n      ) : (\n        <>\n          <div className=\"cart-list\">\n            {cart.map((item, index) => (\n              <div className=\"cart-item\" key={index}>\n                <Link to={`/item/${item.id}`}>\n                  <img src={item.image} alt={item.name} className=\"cart-image\" />\n                </Link>\n                <div className=\"item-details\">\n                  <div className=\"item-name-price\">\n                    <div className=\"item-name\">{item.name}</div>\n                    <div className=\"item-price\">â‚º{item.price.toFixed(2)}</div>\n                    <div>Adults: {item.adults}</div>\n                    <div>Children: {item.children}</div>\n                  </div>\n                </div>\n              </div>\n            ))}\n          </div>\n          <button className=\"item-btn\" onClick={handleCheckout}>Next</button>\n          <Link to=\"/excursions\">\n            <button className=\"item-btn back-btn\">Back to Excursions</button>\n          </Link>\n          <button style={{backgroundColor:\"red\"}} className=\"item-btn\" onClick={() => clearCart()}>Clear</button>\n        </>\n      )}\n    </div>\n  );\n}\n\nexport default Cart;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}